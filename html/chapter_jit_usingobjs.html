<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Max 6 API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
	<div id="c74header">
		<img src="header.png" height="100" />
	</div>
</div>
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('chapter_jit_usingobjs.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Using Jitter Objects in C </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>When developing for Jitter in C, the functionality of pre-existing Jitter objects can be used.</p>
<p>In this chapter, we'll briefly examine instantation and incorporation of the features of the jit.movie and jit.qt.record objects from your C code.</p>
<h1><a class="anchor" id="chapter_jit_usingobjs_ex1"></a>
Example 1: the t_jit_qt_movie object</h1>
<p>Using an object like t_jit_qt_movie from your own code is fairly straightforward. Since it's a standard Jitter object, we can use jit_object_new() and <a class="el" href="group__objectmod.html#ga64970b62e5afe7a2cbd57efd6e9e9f74" title="Frees an object. ">jit_object_free()</a> for instantiation and freeing, jit_object_method() for sending messages, and jit_attr_get... and jit_attr_set... for getting and setting attributes.</p>
<p>For instance, in the following code snippet, we'll create a t_jit_qt_movie object, read a pre-specified movie from disk, and decompress its first frame into a matrix, set to the native size of the movie.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> jit_foo_read_first_movie_frame(</div>
<div class="line">   t_jit_foo *x, <a class="code" href="structt__symbol.html">t_symbol</a> *s, <span class="keywordtype">long</span> ac, <a class="code" href="structt__atom.html">t_atom</a> *av)</div>
<div class="line">{</div>
<div class="line">   <span class="keywordtype">void</span> *qtmovie;</div>
<div class="line"></div>
<div class="line">   <span class="comment">// create the t_jit_qt_movie object, sized to 1x1</span></div>
<div class="line">   qtmovie = jit_object_new(<a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb">gensym</a>(<span class="stringliteral">&quot;jit_qt_movie&quot;</span>), 1, 1);</div>
<div class="line">   <span class="keywordflow">if</span> (qtmovie) {</div>
<div class="line">      <a class="code" href="structt__atom.html">t_atom</a> rv; <span class="comment">// will contain rvarr, with any return values</span></div>
<div class="line">                 <span class="comment">// from our &quot;read&quot; call</span></div>
<div class="line">      <a class="code" href="structt__object.html">t_object</a> *rvarr; <span class="comment">// the t_atomarray with the actual</span></div>
<div class="line">                       <span class="comment">// return values</span></div>
<div class="line"></div>
<div class="line">      <span class="comment">// turn off autostart</span></div>
<div class="line">      <a class="code" href="group__attrmod.html#gafe9a672c8c2eee7c62038dc223beff66">jit_attr_setlong</a>(qtmovie, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb">gensym</a>(<span class="stringliteral">&quot;autostart&quot;</span>), 0);</div>
<div class="line">      <span class="comment">// read the movie, just pass in the args to our function</span></div>
<div class="line">      <a class="code" href="group__obj.html#ga443dee482af22e0fe83e68955d367226">object_method_typed</a>(qtmovie, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb">gensym</a>(<span class="stringliteral">&quot;read&quot;</span>), ac, av, &amp;rv);</div>
<div class="line"></div>
<div class="line">      <span class="comment">// check the return value &amp; verify that the movie loaded</span></div>
<div class="line">      <span class="keywordflow">if</span> (rvarr = <a class="code" href="group__atommod.html#ga84dda6fa7e1e2f29e897c1d87a06ba8e">jit_atom_getobj</a>(&amp;rv)) {</div>
<div class="line">         <span class="keywordtype">long</span> rvac = 0;</div>
<div class="line">         <a class="code" href="structt__atom.html">t_atom</a> *rvav = NULL;</div>
<div class="line"></div>
<div class="line">         <a class="code" href="group__obj.html#gab033973cea2f4a0b17bb48ab2f22f051">object_getvalueof</a>(rvarr, &amp;rvac, &amp;rvav);</div>
<div class="line">         <span class="keywordflow">if</span> (rvac &amp;&amp; rvav) {</div>
<div class="line">            <span class="comment">// just as in Max, we get a list: &quot;filename success&quot;;</span></div>
<div class="line">            <span class="comment">// success of 1 means the read was successful</span></div>
<div class="line">            <span class="keywordflow">if</span> (rvac &gt; 1 &amp;&amp; <a class="code" href="group__atommod.html#gaf63b5b3ffc46134bed05adf071a7d52a">jit_atom_getlong</a>(rvav + 1)) {</div>
<div class="line">               <span class="keywordtype">long</span> dim[2];</div>
<div class="line">               <span class="keywordtype">void</span> *matrix;</div>
<div class="line">               <a class="code" href="structt__jit__matrix__info.html">t_jit_matrix_info</a> info;</div>
<div class="line"></div>
<div class="line">               <span class="comment">// get our movie&#39;s native dims</span></div>
<div class="line">               <a class="code" href="group__attrmod.html#gac22c2370ca40b23c110321f2b3af3d89">jit_attr_getlong_array</a>(qtmovie, <a class="code" href="group__symbol.html#ga5d8db08b384aeb76eaee85a15f46fbcb">gensym</a>(<span class="stringliteral">&quot;movie_dim&quot;</span>),</div>
<div class="line">                  2, dim);</div>
<div class="line">               <span class="comment">// set the t_jit_qt_movie&#39;s dim to match</span></div>
<div class="line">               jit_object_method(qtmovie,<a class="code" href="group__jitter.html#gae59203825989a640817bad4d5b0961dd">_jit_sym_dim</a>,dim[0],dim[1]);</div>
<div class="line">               <span class="comment">// set our matrix up to match</span></div>
<div class="line">               <a class="code" href="group__matrixmod.html#ga9c068d7781425345e99576a1955366af">jit_matrix_info_default</a>(&amp;info);</div>
<div class="line">               info.<a class="code" href="structt__jit__matrix__info.html#aabcce88ec5bd51aea1662efef2adaf9a">type</a> = <a class="code" href="group__jitter.html#ga3a06cf8d41c4f4c017c0bf825fec59f8">_jit_sym_char</a>;</div>
<div class="line">               info.<a class="code" href="structt__jit__matrix__info.html#a4f8e32123477684b18c83ca3d9079803">planecount</a> = 4;</div>
<div class="line">               info.<a class="code" href="structt__jit__matrix__info.html#a51f55844070b10955b23235f6ef68d1c">dimcount</a> = 2;</div>
<div class="line">               info.<a class="code" href="structt__jit__matrix__info.html#a1910d191539aa64e8a949c62629e17b0">dim</a>[0] = dim[0];</div>
<div class="line">               info.<a class="code" href="structt__jit__matrix__info.html#a1910d191539aa64e8a949c62629e17b0">dim</a>[1] = dim[1];</div>
<div class="line">               matrix = jit_object_new(<a class="code" href="group__jitter.html#ga8f405e5881e1e61c374ee50a0b65316e">_jit_sym_jit_matrix</a>, &amp;info);</div>
<div class="line">               <span class="keywordflow">if</span> (matrix) {</div>
<div class="line">                  <span class="comment">// call the t_jit_qt_movie&#39;s matrix_calc method</span></div>
<div class="line">                  <span class="comment">// with our matrix as an argument</span></div>
<div class="line">                  err = (t_jit_err)jit_object_method(qtmovie,</div>
<div class="line">                     <a class="code" href="group__jitter.html#ga3dde1a04b3c379fdebae36d532924b13">_jit_sym_matrix_calc</a>, NULL, matrix);</div>
<div class="line">                  <span class="keywordflow">if</span> (err != JIT_ERR_NONE) {</div>
<div class="line">                     <a class="code" href="group__console.html#ga8a87d2e25431900a88722759ec115757">error</a>(<span class="stringliteral">&quot;something went wrong&quot;</span>);</div>
<div class="line">                  }</div>
<div class="line">                  <span class="comment">// do something with the matrix</span></div>
<div class="line"></div>
<div class="line">                  <span class="comment">// free the matrix</span></div>
<div class="line">                  <a class="code" href="group__objectmod.html#ga64970b62e5afe7a2cbd57efd6e9e9f74">jit_object_free</a>(matrix);</div>
<div class="line">               }</div>
<div class="line">            }</div>
<div class="line">            <a class="code" href="group__memory.html#ga5520eadf3494221726cfaf3cbd35f8e9">freebytes</a>(rvav, <span class="keyword">sizeof</span>(<a class="code" href="structt__atom.html">t_atom</a>) * rvac);</div>
<div class="line">         }</div>
<div class="line">         <a class="code" href="group__class__old.html#gadf30646e52376a37b93cc20efac65636">freeobject</a>(rvarr);</div>
<div class="line">      }</div>
<div class="line">      <a class="code" href="group__objectmod.html#ga64970b62e5afe7a2cbd57efd6e9e9f74">jit_object_free</a>(qtmovie);</div>
<div class="line">   }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Naturally, we could also set the t_jit_qt_movie object's time attribute, or call its or frame method, to recall an arbitrary point in time. In fact, nearly every documented method and attribute of the jit.movie object, as it functions in the Max interface, is available from C. The exceptions are those functions implemented in the Max wrapper object, such as framedump. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
		<div id="c74footer">
			&nbsp;&nbsp;Copyright &copy; 2013, <a href="http://www.cycling74.com/">Cycling '74</a>
		</div>
	</body>
</html>
